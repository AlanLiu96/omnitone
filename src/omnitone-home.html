<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-icons/av-icons.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner-lite.html">
<link rel="import" href="../bower_components/paper-styles/typography.html">

<dom-module id="omnitone-home">
  <template>
    <style>
      p {
        line-height: 28px;
        margin: 0 10px 10px;
        padding: 0;
      }

      .section {
        margin: 30px auto;
        padding: 0;
        text-align: center;
      }

      .section.title {
        color: #FFFFFF;
        background: #546e7a;
        background: radial-gradient(ellipse farthest-side at 50% 0, #546e7a 0%,#263238 100%);
        text-align: center;
        margin: 0;
        padding-top: 70px;
        padding-bottom: 80px;
      }

      .section.title h1 {
        @apply(--paper-font-display3);
        font-size: 52px;
        margin: 15px 0;
        padding: 0;
      }

      .section.title h2 {
        @apply(--paper-font-display2);
        font-size: 28px;
        font-weight: 200;
        line-height: 30px;
        margin: 15px 0;
        padding: 0;
      }

      .section.text {
        max-width: 768px;
      }

      .section.text p {
        @apply(--paper-font-subhead);
        font-size: 16px;
      }

      /*#browser-support {
        margin-top: 30px;
      }

      .browser-support-table {
        @apply(--layout-horizontal);
        width: 256px;
        margin: 10px auto;
        border-top: 1px solid #78909C;
      }

      .browser-column {
        @apply(--layout-flex);
        @apply(--layout-center-justified);
        margin: 10px 0;
      }

      .browser-name {
        @apply(--paper-font-body2);
        padding-bottom: 7px;
      }

      .browser-support-state {
        margin: 0 auto;
        height: 40px;
        width: 40px;
      }

      .circle-green {
        border-radius: 20px;
        background-color: #00E676;
      }

      .circle-gray {
        border-radius: 20px;
        background-color: #B0BEC5;
      }*/

      /*.section.text p.caption {
        @apply(--paper-font-caption);
        white-space: normal;
      }*/

      .section.jumbo {
        @apply(--layout-horizontal);
        @apply(--layout-wrap);
        @apply(--layout-justified);
        max-width: 768px;
      }

      .section.jumbo a {
        text-decoration: none;
        color: #FFFFFF;
      }

      .section.jumbo .jumbo-item {
        @apply(--layout-flex);
        -webkit-flex: 1 1;
        flex: 1 1;
        -webkit-flex-basis: 50%;
        flex-basis: 50%;
        max-width: 50%;
        margin: 10px 0;
      }

      .section.jumbo .jumbo-item p {
        @apply(--paper-font-subhead);
        font-size: 16px;
      }

      /*.button-play-demo {
        height: 180px;
        animation: pulsate 1.5s ease-out;
        animation-iteration-count: infinite;
      }

      .section.jumbo paper-icon-button {
        width: 128px;
        height: 128px;
      }*/

      /*@keyframes pulsate {
        0% { opacity: 0.15; }
        50% { opacity: 1.0; }
        100% { opacity: 0.15; }
      }*/

      .section.resources {
        @apply(--layout-horizontal);
        max-width: 768px;
      }

      .section .grid {
        @apply(--layout-horizontal);
        @apply(--layout-wrap);
        @apply(--layout-justified);
        padding: 0;
        list-style: none;
      }

      .section .grid li {
        -webkit-flex: 1 1;
        flex: 1 1;
        -webkit-flex-basis: 50%;
        flex-basis: 50%;
        max-width: 50%;
        margin-bottom: 20px;
      }

      @media (max-width: 550px) {
        .section.jumbo .jumbo-item {
          -webkit-flex-basis: 100%;
          flex-basis: 100%;
          max-width: 100%;
        }

        .section .grid  li {
          -webkit-flex-basis: 100%;
          flex-basis: 100%;
          max-width: 100%;
        }
      }

      .section.resources h2 {
        font-weight: 400;
        font-size: 22px;
        margin: 0;
      }

      .section.resources p {
        @apply(--paper-font-body1);
        font-size: 14px;
        line-height: 22px;
        display: inline-block;
        margin: 20px;
        padding-top: 20px;
        border-top: 1px solid #B0BEC5;
        text-align: left;
      }

      .section.resources a {
        display: inline-block;
        text-decoration: none;
        color: #0091EA;
        margin: 0;
      }

      .section.footer {
        @apply(--paper-font-title);
        color: #90A4AE;
      }

      paper-spinner-lite {
        --paper-spinner-color: #CFD8DC;
        --paper-spinner-stroke-width: 6px;
      }

      paper-button {
        background-color: #039be5;
        color: white;
        font-size: 16px;
        font-weight: 700;
        padding: 20px;
        margin: 20px 0;
      }

      paper-button iron-icon {
        margin-right: 12px;
      }
    </style>

    <div class="section title">
      <h1>Spatial Audio Renderer</h1>
      <h2>360&#176; Audio on the Web</h2>
    </div>

    <div class="section text">
      <p><strong>SAR</strong> (Spatial Audio Renderer) is a Javascript implementation of a 
        <strong>first-order ambisonic</strong> decoder <br> that allows you to 
        <strong>binaurally render</strong> an ambisonic recording directly on the browser.
        </p>
    </div>

    <div class="section jumbo">
      <div class="jumbo-item">
        <paper-button id="eButtonPlayDemo" raised><iron-icon icon="av:play-circle-filled">
          </iron-icon>Play Demo</paper-button>
        <p id="eText">Use <strong>headphones</strong> to experience the demo
          with the <em>full-sphere surround</em> effect.</p>
      </div>
      <div class="jumbo-item">
        <a href="https://github.com/GoogleChrome/omnitone/" target="_blank">
          <paper-button raised><iron-icon icon="av:library-books"></iron-icon>
            Documentation</paper-button>
        </a>
        <p>Learn how to use <strong>SAR</strong> in your web page.</p>
      </div>
    </div>

    <div class="section resources">
      <ul class="grid">
        <li>
          <h2>Spatial Media</h2>
          <p>A collection of industry standards and tools for 360 video and
            spatial audio. Learn more about spatial media
            <a href="https://github.com/google/spatial-media/" target="_blank">
            here</a>.</p>
        </li>
        <li>
          <h2>VR view</h2>
          <p><a href="https://developers.google.com/vr/concepts/vrview/" target="_blank">VR view</a> 
            allows you to embed 360 degree VR media into websites on desktop and
            mobile, and native apps on Android and iOS.</p>
        </li>
        <li>          
          <h2>Web Audio API</h2>
          <p>Omnitone is written with <a href="https://webaudio.github.io/web-audio-api/" target="_blank">
            Web Audio API</a> for the optimum audio processing in the interactive web apps.</p>
        </li>
        <li>
          <h2>Web VR</h2>
          <p><a href="https://webvr.info/" target="_blank">Web VR</a> is an experimental
            Javascript API that provides access to Virtual Reality devices, such
            as the Oculus Rift or GoogleCardboard, in your browser.</p>
        </li>
      </ul>
    </div>

  </template>

  <script>
    Polymer({

      is: 'omnitone-home',

      properties: {

        visible: {
          type: Boolean,
          observer: '_visibleChanged'
        },

        systemInfo: {
          type: Object,
          value: {}
        }
      },

      _initialize: function () {
        // detect browser and platform.
        var ua = navigator.userAgent, tem,
        M = ua.match(/(opera|chrome|safari|firefox|edge(?=\/))\/?\s*(\d+)/i) || [];
        if (/trident/i.test(M[1])) {
          tem = /\brv[ :]+(\d+)/g.exec(ua) || [];
          return 'IE ' + (tem[1] || '');
        }
        if (M[1] === 'Chrome') {
          tem = ua.match(/\bOPR\/(\d+)/);
          if (tem !== null)
            return 'Opera '+ tem[1];
        }
        M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, '-?'];
        if ((tem = ua.match(/version\/(\d+)/i)) !== null)
          M.splice(1, 1, tem[1]);

        this.systemInfo.browser = M[0];
        this.systemInfo.browserVersion = M[1];

        if (ua.match(/iPad/i) || ua.match(/iPhone/i)) {
          this.systemInfo.platform = 'iOS';
        } else if (ua.match(/Mac OS X/i)) {
          this.systemInfo.platform = 'OSX';
        } else if (ua.match(/Android/i)) {
          this.systemInfo.platform = 'Android';
        } else if (ua.match(/Win/i)) {
          this.systemInfo.platform = 'Windows';
        }

        console.log('[LANDING] system info: ', this.systemInfo);

        // this._verifySystemForDemo();
      },

      // _verifySystemForDemo: function () {
      //   var info = this.systemInfo;
      //   if (info.platform === 'iOS')
      //     return;

      //   if (info.browser === 'Firefox' || info.browser === 'Edge')
      //     return;

      //   // Passed the test, activate the demo link.
      //   this.$.eButtonPlayDemo.disabled = false;
      // },

      attached: function () {
        this._initialize();
      },

      _visibleChanged: function(visible) {
        if (visible) {
          this.fire('change-section', { title: 'Home' });
        }
      }

    });
  </script>

</dom-module>
